<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>BOF - 0xDiablos</title>
  <link rel="shortcut icon" href="/images/diablos.png">

  <!-- Bootstrap core CSS -->
  <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="/css/blog-home.css" rel="stylesheet">
  
</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <a class="navbar-brand" href="/">0xdiablos</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <a class="nav-link" href="/">Home
              <span class="sr-only"></span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/about-us.html">About</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <br><br><br>

  <!-- Page Content -->
  <div class="container" style="background: #222222 !important;">

        <section id="content" class="main">
            <center><h1>Buffer OverFlow - Stack1</h1></center>
        <h6>This will be easy challenge.<br>
              Difficulty: Easy<br>
              Tags: <a href="/Tags/BoF.html">BoF</a>.<br>
              For respect:</h6><img src="https://www.hackthebox.eu/badge/image/47422" alt="Hack The Box">

              <br><br>
                <hr>
                <h2>Quick Summary </h2><br>
                <h6>In the first of all know there is a lot of tutorials published about this area Buffer OverFlow and Binary Exploitation but The best one can explain this part Live OverFlow this guy have Youtube channel and website he upload a lot of thing Related with Reverse engineering general, So today i will solve stack1 in protostar in his website.</h6><br><hr>


                <h2>Source Code</h2><br>
                <h6>In this part i will read the code and i will try to get any bug on it, So see what will happen
                <br></br><img src="/images/BoF/stack1/code.png" class="img-fluid z-depth-1" alt="Responsive image" /></br></br>
                </h6><br><hr>




                <h3>Code Review</h3><br>
                <br></br><img src="/images/BoF/stack1/first.png" class="img-fluid z-depth-1" alt="Responsive image" /></br></br>
                In this part he just Creating variable easy.
                <br></br><img src="/images/BoF/stack1/second.png" class="img-fluid z-depth-1" alt="Responsive image" /></br></br>
                There is if condition What to do ?? <br> It's just to check if there argument after the program name or not <br> if not it will print "please specify an argument" <br>
                <br></br><img src="/images/BoF/stack1/third.png" class="img-fluid z-depth-1" alt="Responsive image" /></br></br>
                In this part he put value in the "modified" so now it's equal "ZERO" Then its take anything will be in the argument and will put it in the "buffer" variable  
                <br></br><img src="/images/BoF/stack1/last.png" class="img-fluid z-depth-1" alt="Responsive image" /></br></br>
                Last part in the code there is another if condition it's compare if "modified" == "0x61626364" or not </h6> <br><hr>





                <h3>Solution time</h3><br>

                <h6>Let's see Who can we get this addr in the if condition<br>
                Here i will use "r2" to read the functions as assembly but you can use anytool you love, np :D 
                <br></br>
                <img src="/images/BoF/stack1/1.png" class="img-fluid z-depth-1" alt="Responsive image" />
                <br></br><img src="/images/BoF/stack1/2.png" class="img-fluid" alt="Responsive image" /></br></br>
                Here we go we got the addr without source code, So what's mean "cmp" that's mean compare
                <br>What next...!?
                <br>Let's full the "buffer" variable How can we do that with python
                <br></br><img src="/images/BoF/stack1/3.png" class="img-fluid" alt="Responsive image" /></br></br>
                That's mean run the program then print "A * 76" so now "buffer" was full to be sure let's do ....
                <br></br><img src="/images/BoF/stack1/4.png" class="img-fluid" alt="Responsive image" /></br></br>
                Now we can see our "C" as hex, So we are in the right way, So what will happen if we did that... 
                <br></br><img src="/images/BoF/stack1/5.png" class="img-fluid" alt="Responsive image" /></br></br>
                Damn thats so easy <br>
                And we did it 
              </h6><hr>
                <h5>I hope u enjoyed with this writeup.
                You can follow me on the twitter <a href="https://twitter.com/MRX_Exploit">@Mrx_Exploit</a>
                <br><br>
                Thanks for reading.</h5>












                <br><br>
        </section>
	
			
    </div>


  <!-- Footer -->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; 0xdiablos team 2019</p>
    </div>
    <!-- /.container -->
  </footer>
  

  <!-- Bootstrap core JavaScript -->
  <script src="/vendor/jquery/jquery.min.js"></script>
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

</html>
